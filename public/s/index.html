<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>二维码扫描</title>
    <link rel="stylesheet" href="/style.css"> <!-- 加载外部样式 -->
</head>
<body>
    <div class="container">
        <h1 id="title">扫描二维码访问链接</h1>
        <img id="qrCode" src="" width="200" alt="QR Code" style="display:none;">
        <p id="originalUrl" style="display:none;">原始链接：<a id="link" href="" target="_blank"></a></p>
        <p id="errorMessage" style="display:none;">二维码生成失败，直接访问链接：<a id="errorLink" href="" target="_blank"></a></p>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const qrData = urlParams.get('qrData'); // 获取URL中的qrData参数
            const originalUrl = urlParams.get('url'); // 获取原始URL参数
            const isMobile = urlParams.get('isMobile') === 'true'; // 获取设备类型参数
            const errorMessage = urlParams.get('errorMessage'); // 获取错误信息参数

            if (isMobile) {
                // 移动设备，直接跳转
                window.location.href = originalUrl;
            } else {
                if (qrData) {
                    // 二维码生成成功，显示二维码
                    document.getElementById('qrCode').src = qrData;
                    document.getElementById('qrCode').style.display = 'block';
                    document.getElementById('originalUrl').style.display = 'block';
                    document.getElementById('link').href = originalUrl;
                    document.getElementById('link').textContent = originalUrl;
                } else {
                    // 二维码生成失败，显示错误信息和原始链接
                    document.getElementById('errorMessage').style.display = 'block';
                    document.getElementById('errorLink').href = originalUrl;
                    document.getElementById('errorLink').textContent = originalUrl;
                }
            }
        });
    </script>
</body>
</html>